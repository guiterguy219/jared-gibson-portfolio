---
import HomeLayout from "@/layouts/HomeLayout.astro";
import { getCollection } from "astro:content";
import ProjectGridItem from "./components/project-grid-item.astro";
import { Content as ProjectsIntroContent } from "./content/projects-intro.md";

const projects = await getCollection("projects").then((projects) =>
  projects.sort((a, b) => {
    if (a.data.lastCommit && b.data.lastCommit) {
      return (
        new Date(b.data.lastCommit).getTime() -
        new Date(a.data.lastCommit).getTime()
      );
    }
    if (a.data.lastCommit) return -1;
    if (b.data.lastCommit) return 1;
    return 0;
  })
);
---

<HomeLayout>
  <div class="markdown-content">
    <ProjectsIntroContent />
  </div>
  <div class="grid grid-cols-1 sm:grid-cols-2 gap-6 h-max">
    {projects.map((project) => <ProjectGridItem project={project} />)}
  </div>
</HomeLayout>
